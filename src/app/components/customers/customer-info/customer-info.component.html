<div class="me-1">
    <div class="d-flex justify-content-between align-items-center pb-2 mt-1 mb-2 border-bottom">
        <h3><i class="bi bi-person-lines-fill me-2 text-primary"></i>Customer Info</h3>
        <div class="d-flex">
            <div class="ms-2">
                <!-- Back / Breadcrumb -->
                <div class="mb-3">
                    <a routerLink="/dashboard/customers" class="text-decoration-none">
                        <i class="bi bi-arrow-left"></i> Back to Customers
                    </a>
                </div>
            </div>
        </div>
    </div>

    @if (errorMsg) {
    <div class="d-flex justify-content-center align-items-center mt-5">
        <div class="card shadow-sm border-warning" style="max-width: 520px;">
            <div class="card-body text-center p-4">
                <!-- Icon -->
                <div class="mb-3">
                    <i class="bi bi-exclamation-triangle-fill text-warning fs-1"></i>
                </div>

                <!-- Title -->
                <h5 class="fw-semibold text-warning mb-2">
                    Invalid Customer
                </h5>

                <!-- Message -->
                <p class="text-muted mb-3">
                    {{ errorMsg }}
                </p>

                <!-- UUID Input -->
                <div class="mb-2">
                    <div class="input-group">
                        <input type="text" class="form-control text-center" placeholder="Paste customer UUID here"
                            [(ngModel)]="enteredUuid" (input)="validateUuid()" />

                        <!-- Paste button -->
                        <button type="button" class="btn btn-outline-secondary" (click)="pasteFromClipboard()"
                            title="Paste from clipboard">
                            <i class="bi bi-clipboard"></i>
                        </button>

                        <!-- Go button -->
                        <button type="button" class="btn btn-warning" [disabled]="!isUuidValid"
                            (click)="navigateWithUuid()">Go</button>
                    </div>
                </div>

                <!-- Inline Validation Error -->
                @if (enteredUuid && !isUuidValid) {
                <div class="text-danger small mb-3">
                    Invalid UUID format
                </div>
                }

                <!-- Actions -->
                <div class="d-flex justify-content-center gap-2">
                    <button class="btn btn-outline-secondary" routerLink="/dashboard/customers">
                        <i class="bi bi-arrow-left"></i> Back to Customers
                    </button>

                    <button class="btn btn-warning" (click)="reload()">
                        <i class="bi bi-arrow-clockwise"></i> Reload Page
                    </button>
                </div>

            </div>
        </div>
    </div>
    }
    @else {
    <div class="container-fluid">
        <!-- Customer Header -->
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start border-bottom pb-2 mb-2">
                    <div>
                        <h4 class="mb-1"><i class="bi bi-person me-2"></i>{{ customer?.name }}</h4>
                        <div class="text-muted small d-none">
                            Customer ID: {{ customer?.uuid }}
                        </div>
                    </div>

                    <div>
                        <button class="btn btn-sm btn-outline-primary me-2" data-bs-toggle="modal"
                            data-bs-target="#customerModal">
                            <i class="bi bi-pencil"></i> Edit
                        </button>
                        <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal"
                            data-bs-target="#confirmDeleteCustomerDialog">
                            <i class="bi bi-trash"></i> Delete
                        </button>
                    </div>
                </div>


                <div class="row g-3">
                    <div class="col-md-4">
                        <strong><i class="bi bi-envelope-at me-1 text-info"></i>Email</strong>
                        <div>{{ customer?.email || 'N/A' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone me-1 text-info"></i>Primary Phone</strong>
                        <div>{{ customer?.primaryPhoneNumber }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone-plus me-1 text-info"></i>Alternate Phone</strong>
                        <div>{{ customer?.alternatePhoneNumber || 'N/A' }}</div>
                    </div>

                    <div class="col-md-8">
                        <strong><i class="bi bi-geo-alt me-1 text-info"></i>Address</strong>
                        <div>{{ customer?.address }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-shield-lock me-1 text-info"></i>Customer UUID</strong>
                        <div>
                            {{ customer?.uuid }}
                            <span>
                                <button class="btn btn-sm btn-outline-secondary" (click)="copyUuid()"
                                    [disabled]="copied">
                                    <i class="bi" [ngClass]="copied ? 'bi-check-lg' : 'bi-copy'"></i>
                                </button>
                                <small *ngIf="copied" class="text-success ms-1">
                                    Copied!
                                </small>

                            </span>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-person me-1 text-info"></i>Created By</strong>
                        <div>{{ customer?.createdBy }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-calendar-plus me-1 text-info"></i>Created At</strong>
                        <div>{{ customer?.createdAt | date:'short' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-calendar-check me-1 text-info"></i>Updated At</strong>
                        <div>{{ customer?.updatedAt | date:'short' }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <ul class="nav nav-tabs mb-3">
            <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="tab" href="#orders">
                    Orders
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#activity">
                    Activity
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#notes">
                    Notes
                </a>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content">

            <!-- Orders -->
            <div class="tab-pane fade show active" id="orders">
                <div class="alert alert-info">
                    Total number of orders so far: {{customer?.printJobIds?.length}}
                </div>
            </div>

            <!-- Activity -->
            <div class="tab-pane fade" id="activity">
                <div class="alert alert-secondary">
                    Customer activity timeline coming soon.
                </div>
            </div>

            <!-- Notes -->
            <div class="tab-pane fade" id="notes">
                <div class="alert alert-light">
                    Internal notes related to this customer.
                </div>
            </div>
        </div>
    </div>
    <app-customer-modal [model]="customer" (successAction)="customerSuccess($event)"
        (errorAction)="customerError($event)"></app-customer-modal>
    <app-confirm-dialog [id]="'confirmDeleteCustomerDialog'" [title]="'Confirm Delete'" [message]="deleteMsg"
        [confirmText]="'Delete'" [cancelText]="'Cancel'" [confirmBtnClass]="'btn-danger'"
        (confirmed)="deleteCustomer()">
    </app-confirm-dialog>
    <app-toast *ngIf="showToast" [type]='toastType' [message]='toastMsg' (closeAction)="hideToastComponent()"></app-toast>
    }
</div>