<div class="me-1">
    <div class="d-flex justify-content-between align-items-center pb-2 mt-1 mb-2 border-bottom">
        <h3><i class="bi bi-person-lines-fill me-2 text-primary"></i>Order Info</h3>
        <div class="d-flex">
            <div class="ms-2">
                <!-- Back / Breadcrumb -->
                <div class="mb-3">
                    <a routerLink="/dashboard/orders" class="text-decoration-none">
                        <i class="bi bi-arrow-left"></i> Back to Orders
                    </a>
                </div>
            </div>
        </div>
    </div>

    @if (errorMsg) {
    <div class="d-flex justify-content-center align-items-center mt-5">
        <div class="card shadow-sm border-warning" style="max-width: 520px;">
            <div class="card-body text-center p-4">
                <!-- Icon -->
                <div class="mb-3">
                    <i class="bi bi-exclamation-triangle-fill text-warning fs-1"></i>
                </div>

                <!-- Title -->
                <h5 class="fw-semibold text-warning mb-2">
                    Invalid Customer
                </h5>

                <!-- Message -->
                <p class="text-muted mb-3">
                    {{ errorMsg }}
                </p>

                <!-- UUID Input -->
                <div class="mb-2">
                    <div class="input-group">
                        <input type="text" class="form-control text-center" placeholder="Paste customer UUID here"
                            [(ngModel)]="enteredUuid" (input)="validateUuid()" />

                        <!-- Paste button -->
                        <button type="button" class="btn btn-outline-secondary" (click)="pasteFromClipboard()"
                            title="Paste from clipboard">
                            <i class="bi bi-clipboard"></i>
                        </button>

                        <!-- Go button -->
                        <button type="button" class="btn btn-warning" [disabled]="!isUuidValid"
                            (click)="navigateWithUuid()">Go</button>
                    </div>
                </div>

                <!-- Inline Validation Error -->
                @if (enteredUuid && !isUuidValid) {
                <div class="text-danger small mb-3">
                    Invalid UUID format
                </div>
                }

                <!-- Actions -->
                <div class="d-flex justify-content-center gap-2">
                    <button class="btn btn-outline-secondary" routerLink="/dashboard/customers">
                        <i class="bi bi-arrow-left"></i> Back to Customers
                    </button>

                    <button class="btn btn-warning" (click)="reload()">
                        <i class="bi bi-arrow-clockwise"></i> Reload Page
                    </button>
                </div>

            </div>
        </div>
    </div>
    }
    @else {
    <div class="container-fluid">
        <!-- Customer Header -->
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start border-bottom pb-2 mb-2">
                    <div>
                        <h4 class="mb-1"><i class="bi bi-box me-2 text-primary"></i>{{ order?.uuid }}</h4>
                    </div>

                    <div>
                        <button class="btn btn-sm btn-outline-primary me-2" data-bs-toggle="modal"
                            data-bs-target="#orderModal">
                            <i class="bi bi-pencil"></i> Edit
                        </button>
                        <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal"
                            data-bs-target="#confirmDeleteCustomerDialog">
                            <i class="bi bi-trash"></i> Delete
                        </button>
                    </div>
                </div>


                <div class="row g-3">
                    <div class="col-md-4">
                        <strong><i class="bi bi-envelope-at me-1 text-info"></i>Job Name</strong>
                        <div>{{order?.jobTypeName}}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-envelope-at me-1 text-info"></i>Job Id</strong>
                        <div>{{ order?.jobId || 'N/A'}}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone me-1 text-info"></i>Quantity</strong>
                        <div>{{ order?.quantity }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-calendar-plus me-1 text-info"></i>Date of delivery</strong>
                        <div>{{ order?.dateOfDelivery | date:'short' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone-plus me-1 text-info"></i>Book Number</strong>
                        <div>{{ order?.bookNumber || 'N/A' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone-plus me-1 text-info"></i>W-Book Number</strong>
                        <div>{{ order?.wBookNumber || 'N/A' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone-plus me-1 text-info"></i>Payment Status</strong>
                        <div>{{ order?.paymentStatus || 'N/A' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone-plus me-1 text-info"></i>Order Status</strong>
                        <div>{{ order?.printJobStatus || 'N/A' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone-plus me-1 text-info"></i>Pending Amount</strong>
                        <div>{{ order?.pendingAmount || 'N/A' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone-plus me-1 text-info"></i>Total Amount</strong>
                        <div>{{ order?.totalAmount || 'N/A' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone-plus me-1 text-info"></i>Discounted Amount</strong>
                        <div>{{ order?.discountedAmount || 'N/A' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-telephone-plus me-1 text-info"></i>Deposited Amount</strong>
                        <div>{{ order?.depositAmount || 'N/A' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-person me-1 text-info"></i>Created By</strong>
                        <div>{{ order?.createdBy }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-calendar-plus me-1 text-info"></i>Created At</strong>
                        <div>{{ order?.createdAt | date:'short' }}</div>
                    </div>

                    <div class="col-md-4">
                        <strong><i class="bi bi-calendar-check me-1 text-info"></i>Updated At</strong>
                        <div>{{ order?.updatedAt | date:'short' }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <ul class="nav nav-tabs mb-3">
            <li class="nav-item">
                <a class="nav-link active" data-bs-toggle="tab" href="#order-details">
                    Orders
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#activity">
                    Activity
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#notes">
                    Notes
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#attached-files">
                    Attached Files
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#payment-history">
                    Payment History
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-bs-toggle="tab" href="#customer-details">
                    Customer Details
                </a>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content">

            <!-- Orders -->
            <div class="tab-pane fade show active" id="order-details">
                <div class="alert alert-info">
                    Total number of orders so far: {{order?.id}}
                </div>
            </div>

            <!-- Activity -->
            <div class="tab-pane fade" id="activity">
                <div class="alert alert-secondary">
                    Order activity timeline coming soon.
                </div>
            </div>

            <!-- Notes -->
            <div class="tab-pane fade" id="notes">
                @if(order?.note === ''){
                <div class="alert alert-light">
                    No note
                </div>
                }
                @else{
                <div class="alert alert-light">
                    {{order?.note}}
                </div>
                }
            </div>

            <!-- Attached Files -->
            <div class="tab-pane fade" id="attached-files">
                <div class="alert alert-info">
                    Total number of attached-files: {{order?.attachmentIds?.length}}
                </div>
            </div>

            <!-- Payment History -->
            <div class="tab-pane fade" id="payment-history">
                <div class="table-responsive mt-1">
                    <table class="table table-striped table-hover align-middle">
                        <tr>
                            <th scope="row">Total Amount</th>
                            <td>{{order?.totalAmount}}</td>
                        </tr>
                        <tr>
                            <th scope="row">Discounted Amount</th>
                            <td>{{order?.discountedAmount}}</td>
                        </tr>
                        <tr>
                            <th scope="row">pending Amount</th>
                            <td>{{order?.pendingAmount}}</td>
                        </tr>
                        <tr>
                            <th scope="row">Payment </th>
                            <td>{{order?.customerAlternatePhone}}</td>
                        </tr>
                        <tr>
                            <th scope="row">Customer Address</th>
                            <td>{{order?.customerAddress}}</td>
                        </tr>
                    </table>
                </div>
            </div>

            <!-- Customer Details -->
            <div class="tab-pane fade" id="customer-details">
                <div class="table-responsive mt-1">
                    <table class="table table-striped table-hover align-middle">
                        <tr>
                            <th scope="row">ID</th>
                            <td>{{order?.customerId}}</td>
                        </tr>
                        <tr>
                            <th scope="row">Customer Name</th>
                            <td>{{order?.customerName}}</td>
                        </tr>
                        <tr>
                            <th scope="row">Primary Phone Number</th>
                            <td>{{order?.customerPrimaryPhone}}</td>
                        </tr>
                        <tr>
                            <th scope="row">Alternate Phone Name</th>
                            <td>{{order?.customerAlternatePhone}}</td>
                        </tr>
                        <tr>
                            <th scope="row">Customer Address</th>
                            <td>{{order?.customerAddress}}</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <app-order-modal [model]="order" (successAction)="orderSuccess($event)"
        (errorAction)="orderError($event)"></app-order-modal>
    <app-confirm-dialog [id]="'confirmDeleteCustomerDialog'" [title]="'Confirm Delete'" [message]="deleteMsg"
        [confirmText]="'Delete'" [cancelText]="'Cancel'" [confirmBtnClass]="'btn-danger'"
        (confirmed)="deleteCustomer()">
    </app-confirm-dialog>
    <app-toast *ngIf="showToast" [type]='toastType' [message]='toastMsg'
        (closeAction)="hideToastComponent()"></app-toast>
    }
</div>